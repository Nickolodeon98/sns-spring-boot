# 💡 미션 요구사항 분석 & 체크리스트

---

- Swagger 적용 [O]
  - API 문서 자동화
- Dockerfile 추가, 변경사항 발생 시 자동으로 Docker 빌드해서 이미지 생성하게끔 설정 [O]
- JPA 사용할 수 있도록 application.yml 파일에서 설정값들 변경 [O]
- 회원가입 기능 구현 [O]
  - 패스워드 암호화 기능 구현
- 로그인 구현 [O]
  - JWT 활용, 토큰 생성 시 비밀 키로 암호화하도록 구현
- 포스트 등록 기능 구현 [O]
  - 권한이 있는 사용자만 포스트를 작성할 수 있는 API 작성 
- 포스트 작성 시 등록 날짜와 시간이 저장되는 기능 구현 [O]
  - JPA Auditing 기능 활용
- 포스트 조회 기능 구현 [O]
  - 포스팅된 게시물 한 개 조회하는 기능
  - 등록된 모든 포스트를 조회하는 기능
    - 포스트 조회는 비회원과 회원 모두 가능하도록 구현
- 등록된 포스트를 수정하는 기능 구현 [O]
- 등록된 포스트 삭제 기능 구현 [O]

# 🎨 1주차 미션 요약

---

## 준비 단계

---

### 1. 브랜치 및 이슈 트래커 사용

- **수행 과정**
```
1. 위 체크리스트에 명시된 기능 각각을 구현하기 전에 GitLab 의 이슈 생성 기능을 활용하여 해결할 문제 요약
2. 해결할 문제 별로 브랜치를 생성하여 코드의 수정은 생성된 브랜치에서 문제를 해결될 때까지 진행
3. 해결이 된 후 브랜치는 미션 1 브랜치인 sprint1 에 병합
```
- **중점에 둔 사항**
```
1. 이슈를 생성할 때 각 이슈별로 명시된 것 이상의 기능을 구현하지 않도록 유의    
2. 최대한 작은 단위로 기능을 묶어서 이슈로 등록 후 구현하도록 함
```

### 2. CI/CD 적용

- **수행 과정**
``` 
1. 프로젝트 배포의 자동화를 위해 GitLab의 CI 구축 기능인 파이프라인 에디터로 YAML 파일을 작성
2. YAML 파일 작성을 위해 tutorialspoint 와 stackoverflow 를 참고
3. Docker Build 후 이미지를 생성하였으므로 docker docs 공식문서를 참고하여 Dockerfile 을 작성
```
- **참고 문헌**
```
https://www.tutorialspoint.com/yaml/yaml_indentation_and_separation.htm
https://stackoverflow.com/questions/42247535/yaml-how-many-spaces-per-indent
```

## 구현 단계

---

### 회원가입 및 로그인 기능

1) **POST api/v1/users/join**
```
기능:

- 사용할 아이디와 비밀번호로 사용자를 회원으로 등록

요구 사항:

- 회원 가입이 성공하는 경우:

 "SUCCESS" 메시지와 함께 DB 의 User 테이블에 다음 정보가 저장된다:
 
 1. 등록된 사용자 아이디
 2. 비밀번호
 3. 등록이 이루어진 날짜와 시간
 
- 회원 가입에 실패하는 경우:
 
 1. 중복된 아이디로 회원가입 시도가 발생한 경우
 
 "ERROR" 메시지와 함께 상세한 에러 정보를 포함한 JSON 데이터로 응답한다.
```
2) **POST api/v1/users/login**
```
기능:

- 입력된 아이디와 비밀번호로 로그인하여 토큰을 발급

요구 사항:

- 로그인이 성공적으로 이루어졌을 때 다음과 같이 동작한다:
 
 1. 입력한 아이디 정보가 들어 있는 JSON Web token 이 발급된다.
 2. "SUCCESS" 메시지와 토큰 값이 함께 JSON 형태 데이터로 응답된다. 
 
- 다음과 같은 상황은 예외로 처리한다:
 
 1. 회원가입 되지 않은 사용자 아이디가 입력되었을 때
 2. 아이디와 비밀번호가 회원가입 시에 입력한 내용과 일치하지 않을 때

참고 문헌:

https://itistori.tistory.com/37
```

3) **POST api/v1/posts**
```
기능:

- 포스트를 등록함

요구 사항:

- Spring Security 를 활용해 토큰을 가지고 인증 절차를 거쳐야만 포스트 등록이 가능하도록 구현:
 
 1. JWT 를 사용하여, Bearer 로 시작하는 토큰 값을 서버에서 요청 시 헤더에 담는다. 
 
- 다음과 같은 상황은 예외로 처리한다:
 
 1. 토큰으로 인증 절차를 거치지 않은 사용자가 API 를 호출해 등록을 시도할 때  

중점 사항:

- 토큰 필터에서 발생한 예외를 클라이언트가 알아볼 수 있는 JSON 형태로 반환하도록 구현 

참고 문헌:

https://medium.com/@mypascal2000/custom-handling-of-invalid-jwt-in-spring-boot-f66e60d59230
```

4) **GET api/v1/posts/{postId}**
```
기능:

- 아이디 postId 의 포스트의 상세 정보를 조회함 

요구 사항:

- 조회 시 포스트의 다음 정보를 알 수 있다:
 
  > 아이디
  > 제목
  > 내용
  > 등록 날짜
  > 마지막 수정 날짜
  > 작성자 
 
- 다음과 같은 상황은 예외로 처리한다:
 
 1. 아이디가 DB에 없을 때

중점 사항:

- 성공 시와 에러 시 모두 JSON 형태의 응답을 반환하도록 구현 
```

5) **PUT api/v1/posts**
```
기능:

- 포스트를 수정함

요구 사항:

- 포스트를 작성한 사용자로 로그인 되어 있을 때만 포스트 수정이 가능하도록 구현
  
- 다음과 같은 상황은 예외로 처리한다:
 
 1. 현재 로그인한 사용자가 작성자가 아닐 때
 2. 입력된 고유 아이디로 수정하고자 하는 포스트를 찾을 수 없을 때 

중점 사항:

- 포스트 수정이 되면 작성자와 고유 아이디는 그대로 남고 제목과 내용 및 수정 날짜/시간만 업데이트 되게 구현  
```

6) **DELETE api/v1/posts**
```
기능:

- 포스트를 삭제함
```
7) **GET api/v1/posts**

```
기능:

- DB에 등록된 모든 포스트를 조회함 
```

### 특이사항

---

- DB 에러를 처리하는 부분을 정확하게 구현하지 못함
- 몇몇 이슈 해결을 due date 에 맞추지 못함


### 리팩토링 시 주로 다루어야 할 이슈들

---

- 테스트 코드 상의 중복 제거
- Fixture 사용